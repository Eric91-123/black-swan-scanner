<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>é»‘å¤©é¹…è‚¡ç¥¨åˆ†æç³»ç»Ÿ</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f8fa; padding:20px; }
    h1 { color:#222; }
    table { border-collapse: collapse; width:100%; background:#fff; }
    th, td { border:1px solid #ddd; padding:8px; text-align:center; }
    th { background:#f0f0f0; }
    .score { font-weight:bold; }
  </style>
</head>

<body>

<h1>ğŸ¦¢ é»‘å¤©é¹…è‚¡ç¥¨åˆ†æç³»ç»Ÿï¼ˆç¾è‚¡ Demoï¼‰</h1>

<p>
é€»è¾‘ï¼šç­›é€‰è¿‘æœŸå‡ºç°â€œæç«¯ä¸‹è·Œâ€çš„è‚¡ç¥¨ï¼Œåˆ¤æ–­æ˜¯å¦å±äº<br>
<strong>äº‹ä»¶å†²å‡» / æƒ…ç»ªé”™æ€ / ä¸šåŠ¡å´©å</strong>
</p>

<button onclick="loadStocks()">åŠ è½½çœŸå®ç¾è‚¡æ•°æ®</button>

<br><br>

<table id="stockTable">
  <thead>
    <tr>
      <th>ä»£ç </th>
      <th>å…¬å¸</th>
      <th>ä»·æ ¼</th>
      <th>æ—¥æ¶¨è·Œ</th>
      <th>å¸‚å€¼(äº¿ç¾å…ƒ)</th>
      <th>é»‘å¤©é¹…åˆ¤æ–­</th>
      <th>ç ”ç©¶ç»“è®º</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API_KEY = "1Y8JOonWgfa7av3t8rPElUlGP5SNnWBz";

async function loadStocks() {
  const tbody = document.querySelector("#stockTable tbody");
  tbody.innerHTML = "åŠ è½½ä¸­...";

  const url = `https://financialmodelingprep.com/api/v3/stock_market/actives?apikey=${API_KEY}`;

  try {
    const res = await fetch(url);
    const data = await res.json();

    tbody.innerHTML = "";

    data.slice(0, 10).forEach(stock => {
      const change = stock.changesPercentage || 0;

      let swan = "æ­£å¸¸æ³¢åŠ¨";
      let conclusion = "æ— æ˜æ˜¾é”™æ€";

      if (change < -8) {
        swan = "âš ï¸ é»‘å¤©é¹…è§‚å¯Ÿ";
        conclusion = "éœ€åˆ¤æ–­äº‹ä»¶å†²å‡» vs æƒ…ç»ªææ…Œ";
      }

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${stock.symbol}</td>
        <td>${stock.name || "-"}</td>
        <td>${stock.price}</td>
        <td>${change.toFixed(2)}%</td>
        <td>${(stock.marketCap/1e9).toFixed(1)}</td>
        <td class="score">${swan}</td>
        <td>${conclusion}</td>
      `;
      tbody.appendChild(tr);
    });

  } catch (e) {
    tbody.innerHTML = "âŒ æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ API Key";
  }
}
</script>

</body>
</html>
